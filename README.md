# FMA-GEN
This is the official repository for our recent paper "FMA-GEN: Controllable Multi-Conditional Few-Shot Diffusion for Medical Anomaly Generation and Detectio".

**Abstract**
Medical anomaly detection remains a challenging problem due to the extreme scarcity, morphological diversity, and lack of precise annotations associated with abnormal samples. These limitations significantly hinder the scalability and robustness of supervised methods, particularly in clinical scenarios where acquiring well-annotated anomalies is costly and impractical. To address this, we propose FMA-GEN, a novel diffusionbased framework for few-shot, multi-conditional controllable medical anomaly generation and detection. Specifically, FMAGEN first introduces a text-guided anomaly mask generator that enables spatial and morphological control over anomaly regions, allowing the creation of diverse and semantically meaningful masks. These masks, combined with anomaly embeddings and textual prompts, are used to condition the diffusion process, facilitating the synthesis of high-fidelity and controllable anomalous images. To ensure anatomical realism, we further design a boundary-aware blending module that adaptively fuses normal and abnormal regions along mask boundaries. Finally, in the downstream detection stage, we develop a semi-supervised learning scheme that leverages the generated samples to enhance anomaly representation. A mask-guided feature mining strategy is employed to highlight discriminative abnormal features while suppressing interference from normal regions. Extensive experiments on the BraTS and LiverCT datasets demonstrate that FMA-GEN generates realistic and diverse anomalies, leading to significant improvements in both anomaly detection and localization tasks.
